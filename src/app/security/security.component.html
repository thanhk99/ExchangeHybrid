<app-nav-tabs [tabs]="profiletabs"></app-nav-tabs>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" />
<div class="security-container">
  <h2>Trung t√¢m b·∫£o m·∫≠t</h2>

  <!-- Th√¥ng b√°o b·∫£o m·∫≠t -->
  <div class="security-alert">
    <div class="alert-icon">‚ö†Ô∏è</div>
    <div>
      <div class="alert-title">M·ª•c b·∫£o m·∫≠t ch·ªù x·ª≠ l√Ω</div>
      <div class="alert-desc">B·∫£o v·ªá t√†i kho·∫£n b·∫±ng c√°ch b·∫≠t c√°c t√≠nh nƒÉng b·∫£o m·∫≠t ƒë∆∞·ª£c ƒë·ªÅ xu·∫•t.</div>
    </div>
  </div>

  <!-- Danh s√°ch b·∫£o m·∫≠t -->
  <div class="security-item" *ngFor="let item of securityItems">
    <div class="item-icon">{{ item.icon }}</div>
    <div class="item-content">
      <div class="item-title">
        {{ item.title }}
        <span *ngIf="item.recommended" class="recommended-badge">ƒê∆∞·ª£c ƒë·ªÅ xu·∫•t</span>
      </div>
      <div class="item-desc">{{ item.desc }}</div>
    </div>
    <button class="setup-btn" (click)="setupItem(item)">Thi·∫øt l·∫≠p</button>
  </div>

  <!--M·∫≠t kh·∫©u c·∫•p 2-->
  <div class="modal-overlay" *ngIf="showPasswordSection">
    <div class="modal-container">
      <div class="modal-header">
        <h2>Trung t√¢m b·∫£o m·∫≠t > M·∫≠t kh·∫©u c·∫•p 2</h2>
        <button (click)="showPasswordSection = false">√ó</button>
      </div>

      <div class="modal-body">
        <h3>Thi·∫øt l·∫≠p m·∫≠t kh·∫©u c·∫•p 2</h3>

        <div class="form-group">
          <label for="passwordLevel2">M·∫≠t kh·∫©u c·∫•p 2 (6 ch·ªØ s·ªë)</label>
          <div class="password-input">
            <input [type]="showPassword ? 'text' : 'password'" id="passwordLevel2" [(ngModel)]="password" maxlength="6"
              placeholder="Nh·∫≠p 6 s·ªë" (keypress)="onlyNumberKey($event)" />
            <span class="toggle-password" (click)="togglePasswordVisibility()">
              <i class="fas" [ngClass]="{'fa-eye': !showPassword, 'fa-eye-slash': showPassword}"></i>
            </span>
          </div>
        </div>

        <div class="form-group">
          <label for="confirmPasswordLevel2">X√°c nh·∫≠n m·∫≠t kh·∫©u</label>
          <div class="password-input">
            <input [type]="showConfirmPassword ? 'text' : 'password'" id="confirmPasswordLevel2"
              [(ngModel)]="confirmPassword" maxlength="6" placeholder="X√°c nh·∫≠n 6 s·ªë"
              (keypress)="onlyNumberKey($event)" />
            <span class="toggle-password" (click)="toggleConfirmPasswordVisibility()">
              <i class="fas" [ngClass]="{'fa-eye': !showConfirmPassword, 'fa-eye-slash': showConfirmPassword}"></i>
            </span>
          </div>
        </div>

        <div class="button-group">
          <button class="submit-btn" (click)="save()">X√°c nh·∫≠n</button>
          <button class="cancel-btn" (click)="showPasswordSection = false">H·ªßy</button>
        </div>
      </div>
    </div>
  </div>

  <!-- M√£ ch·ªëng l·ª´a ƒë·∫£o -->
  <div class="modal-overlay" *ngIf="showAntiPhishingModal">
    <div class="modal-container">
      <div class="modal-header">
        <h2>Trung t√¢m b·∫£o m·∫≠t > M√£ ch·ªëng l·ª´a ƒë·∫£o</h2>
        <button (click)="showAntiPhishingModal = false">√ó</button>
      </div>

      <div class="modal-body">
        <h3>T·∫°o m√£ c·ªßa b·∫°n</h3>
        <p>T√¨m hi·ªÉu th√™m</p>

        <div class="form-group">
          <label>M√£ ch·ªëng l·ª´a ƒë·∫£o</label>
          <div class="code-input-group">
            <input type="text" [(ngModel)]="antiPhishingCode" placeholder="Nh·∫≠p m√£ m√† ch·ªâ b·∫°n c√≥ th·ªÉ nh·∫≠n ra">
          </div>

          <div class="requirements">
            <div [class.valid]="(antiPhishingCode.length || 0) >= 1 && (antiPhishingCode.length || 0) <= 20">
              ‚úì 1 - 20 k√Ω t·ª±
            </div>
            <div [class.valid]="isValidCodeFormat(antiPhishingCode)">
              ‚úì Ch·ªâ ch·ª©a ch·ªØ c√°i v√† ch·ªØ s·ªë (A-Z, a-z, 0-9)
            </div>
          </div>
        </div>

        <button class="submit-btn" [disabled]="!isValidCode(antiPhishingCode)" (click)="saveAntiPhishingCode()">
          G·ª≠i
        </button>
      </div>
    </div>
  </div>
  <!-- Modal ƒë·∫∑t m·∫≠t kh·∫©u ƒëƒÉng nh·∫≠p -->

  <div class="modal-overlay" *ngIf="showPasswordModal">
    <div class="modal-container">
      <div class="modal-header">
        <h2>Trung t√¢m b·∫£o m·∫≠t > Thay ƒë·ªïi m·∫≠t kh·∫©u</h2>
        <button (click)="showPasswordModal = false">√ó</button>
      </div>

      <div class="modal-body">
        <h3>Thay ƒë·ªïi m·∫≠t kh·∫©u</h3>

        <div class="form-group">
          <label>M·∫≠t kh·∫©u m·ªõi</label>
          <div class="password-input">
            <input [type]="shownewPassword ? 'text' : 'password'" [(ngModel)]="newPassword"
              placeholder="Vui l√≤ng nh·∫≠p m·∫≠t kh·∫©u m·ªõi" />
            <span class="toggle-password" (click)="toggleNewPasswordVisibility()">
              <i class="fas" [ngClass]="{'fa-eye': !shownewPassword, 'fa-eye-slash': shownewPassword}"></i>
            </span>
          </div>
        </div>

        <div class="form-group">
          <label>X√°c nh·∫≠n m·∫≠t kh·∫©u m·ªõi</label>
          <div class="password-input">
            <input [type]="showConfirmPassword ? 'text' : 'password'" [(ngModel)]="confirmPassword"
              placeholder="Vui l√≤ng nh·∫≠p m·∫≠t kh·∫©u m·ªõi" />
            <span class="toggle-password" (click)="toggleConfirmPasswordVisibility()">
              <i class="fas" [ngClass]="{'fa-eye': !showConfirmPassword, 'fa-eye-slash': showConfirmPassword}"></i>
            </span>
          </div>
        </div>

        <div class="verification-section">
          <h4>X√°c th·ª±c qua email</h4>
          <div class="code-input">
            <input type="text" [(ngModel)]="smsCode" placeholder="Nh·∫≠p m√£" />
            <button (click)="sendSMSCode()">G·ª≠i m√£</button>
          </div>
        </div>

        <button class="submit-btn" [disabled]="!isValidPassword()" (click)="updatePassword()">
          X√°c nh·∫≠n
        </button>
      </div>
    </div>
  </div>

  <!-- Ph∆∞∆°ng th·ª©c x√°c th·ª±c -->

  <h3>Ph∆∞∆°ng th·ª©c x√°c th·ª±c</h3>


  <div class="auth-method">
    <div class="method-info">
      <div class="method-title">X√°c th·ª±c qua email</div>
      <div class="method-desc">Nh·∫≠n m√£ x√°c th·ª±c qua email</div>
    </div>
    <div class="method-action">
      <span class="masked-info">{{ maskEmail(user.email) }}</span>
      <button class="change-btn" (click)="openEmailModal()">Thay ƒë·ªïi</button>
    </div>
  </div>
</div>

<!-- Modal thay ƒë·ªïi email -->
<div class="modal-overlay" *ngIf="showEmailModal">
  <div class="modal-container">
    <h1>Thay ƒë·ªïi email</h1>

    <div class="security-notice">
      <input type="checkbox" id="email-security-checkbox" checked disabled>
      <label for="email-security-checkbox">
        ƒê·ªÉ b·∫£o v·ªá t√†i kho·∫£n, b·∫°n s·∫Ω kh√¥ng th·ªÉ r√∫t ti·ªÅn ho·∫∑c s·ª≠ d·ª•ng giao d·ªãch P2P ƒë·ªÉ b√°n ti·ªÅn m√£ h√≥a
        trong 24 gi·ªù sau khi b·∫°n ƒë·∫∑t l·∫°i ho·∫∑c thay ƒë·ªïi email t√†i kho·∫£n c·ªßa m√¨nh.
      </label>
    </div>

    <div class="form-section">
      <h2>ƒê·ªãa ch·ªâ email m·ªõi</h2>
      <div class="code-input-group">
        <input type="email" [(ngModel)]="newEmail" placeholder="Nh·∫≠p ƒë·ªãa ch·ªâ email m·ªõi">
      </div>
    </div>

    <div class="verification-section">
      <h2>X√°c th·ª±c qua email m·ªõi</h2>
      <div class="code-input-group">
        <input type="text" [(ngModel)]="newEmailCode" placeholder="Nh·∫≠p m√£">
        <button class="send-code-btn" (click)="sendNewEmailCode()">G·ª≠i m√£</button>
      </div>

      <h2>X√°c th·ª±c qua email hi·ªán t·∫°i</h2>
      <div class="code-input-group">
        <input type="text" [(ngModel)]="currentEmailCode" placeholder="Nh·∫≠p m√£">
        <button class="send-code-btn" (click)="sendCurrentEmailCode()">G·ª≠i m√£</button>
      </div>

      <!-- <h2>X√°c th·ª±c qua ƒëi·ªán tho·∫°i</h2>
      <div class="code-input-group">
        <input type="text" [(ngModel)]="phoneCode" placeholder="Nh·∫≠p m√£">
        <button class="send-code-btn" (click)="sendPhoneVerificationCode()">G·ª≠i m√£</button>
      </div> -->
    </div>

    <div class="no-auth-section">
      <h2 style="cursor: pointer;">Kh√¥ng c√≥ ph∆∞∆°ng th·ª©c x√°c th·ª±c?</h2>
      <button class="confirm-btn" (click)="confirmEmailChange()">X√°c nh·∫≠n</button>
    </div>

    <div class="modal-actions">
      <button class="cancel-btn" (click)="closeModal()">H·ªßy</button>
    </div>
  </div>
</div>

<div class="container">
  <h2>B·∫£o m·∫≠t t√†i kho·∫£n</h2>

  <div class="section">
    <h3>Qu·∫£n l√Ω</h3>
    <div class="option">
      <span>üìù</span> Qu·∫£n l√Ω thi·∫øt b·ªã
      <span class="link" (click)="goToDevice()">Qu·∫£n l√Ω</span>
    </div>
    <div class="option">
      <span>üîí</span> Qu·∫£n l√Ω x√°c minh hai y·∫øu t·ªë
      <span class="link">Qu·∫£n l√Ω</span>
    </div>
  </div>

  <div class="section">
    <h3>Quy·ªÅn giao d·ªãch</h3>
    <div class="option">
      <span>üìã</span> Thi·ªát l·∫≠p c·∫•p ƒë·ªô quy·ªÅn giao d·ªãch chi b·∫£n
      <span class="link">T·∫Øt/B·∫≠t</span>
    </div>
  </div>

  <div class="section">
    <h3>Qu·∫£n l√Ω t√†i kho·∫£n</h3>
    <div class="option">
      <span>üí≥</span> ƒê·ªïi b·∫£ng t√†i kho·∫£n b·ªã bƒÉng ƒëong. ƒê·ªÉ m·ªü kh√≥a t√†i kho·∫£n, h√£y b·∫£o ƒë·∫£m b·∫°n ƒë√£ ƒëƒÉng nh·∫≠p t√†i kho·∫£n
      <span class="link">></span>
    </div>
    <div class="option">
      <span>üîê</span> ƒê·ªông t√†i kho·∫£n
      <span class="link">></span>
    </div>
  </div>
</div>
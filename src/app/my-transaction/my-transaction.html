<div class="order-page">
  <!-- Tabs -->
  <div class="tabs-container">
    <div class="tabs">
      <div [class.active]="tab === 'pending'" (click)="setTab('pending')">ƒêang ch·ªù x·ª≠ l√Ω</div>
      <div [class.active]="tab === 'completed'" (click)="setTab('completed')">ƒê√£ ho√†n t·∫•t</div>
    </div>

    <div class="right-actions">
      <button (click)="reportUser()"> B√°o c√°o ng∆∞·ªùi d√πng</button>
      <button (click)="exportReport()"> Xu·∫•t b√°o c√°o</button>
    </div>
  </div>

  <!-- Filters -->
  <div class="filters">

    <!-- Dropdown tr·∫°ng th√°i -->
    <div class="dropdown" [class.open]="openDropdown === 'status'" (click)="$event.stopPropagation()">
      <button class="dropdown-btn" (click)="toggleDropdown('status')">
        {{ selectedStatus || 'T·∫•t c·∫£ tr·∫°ng th√°i' }}
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="3" stroke="currentColor"
          class="chevron" [class.open]="openDropdown === 'status'">
          <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5"></path>
        </svg>
      </button>
      <div class="dropdown-menu" *ngIf="openDropdown === 'status'">
        <div class="dropdown-item" (click)="selectStatus('')">T·∫•t c·∫£ tr·∫°ng th√°i</div>
        <div class="dropdown-item" (click)="selectStatus('Ch·ªù x√°c nh·∫≠n')">ƒê√£ th·ª±c hi·ªán</div>
        <div class="dropdown-item" (click)="selectStatus('ƒêang x·ª≠ l√Ω')">ƒê√£ hu·ª∑</div>
      </div>
    </div>

    <!-- Dropdown l·ªánh -->
    <div class="dropdown" [class.open]="openDropdown === 'order'" (click)="$event.stopPropagation()">
      <button class="dropdown-btn" (click)="toggleDropdown('order')">
        {{ selectedOrder || 'T·∫•t c·∫£ l·ªánh' }}
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="3" stroke="currentColor"
          class="chevron" [class.open]="openDropdown === 'order'">
          <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5"></path>
        </svg>
      </button>
      <div class="dropdown-menu" *ngIf="openDropdown === 'order'">
        <div class="dropdown-item" (click)="selectOrder('')">T·∫•t c·∫£ l·ªánh</div>
        <div class="dropdown-item" (click)="selectOrder('Mua')">Mua</div>
        <div class="dropdown-item" (click)="selectOrder('B√°n')">B√°n</div>
      </div>
    </div>


    <!-- Date Range -->
    <input type="date" [(ngModel)]="startDate">
    <span>‚Üí</span>
    <input type="date" [(ngModel)]="endDate">

    <!-- Search -->
    <input type="text" placeholder="T√¨m ki·∫øm t√™n ng∆∞·ªùi d√πng, ID" [(ngModel)]="searchTerm" />

    <!-- Reset -->
    <button class="reset-btn" (click)="resetFilters()">ƒê·∫∑t l·∫°i</button>
  </div>

  <!-- No Records -->
  <div *ngIf="tab === 'completed' && completedOrders.length === 0" class="no-records">
    <div class="no-records-icon">üìÑ</div>
    <div class="no-records-text">
      <strong>Kh√¥ng t√¨m th·∫•y h·ªì s∆°</strong><br />
      <span>Ch∆∞a c√≥ l·ªánh ƒë√£ ho√†n t·∫•t</span>
    </div>
  </div>

  <!-- N·∫øu c√≥ d·ªØ li·ªáu -->
  <table class="order-table" *ngIf="tab === 'completed' && completedOrders.length > 0">
    <thead>
      <tr>
        <th>ID l·ªánh</th>
        <th>Lo·∫°i l·ªánh</th>
        <th>S·ªë l∆∞·ª£ng ƒë·∫∑t l·ªánh</th>
        <th>S·ªë ti·ªÅn ƒë·∫∑t l·ªánh</th>
        <th>ƒê∆°n gi√°</th>
        <th>ƒê·ªëi t√°c</th>
        <th>Tr·∫°ng th√°i l·ªánh</th>
        <th>Ng√†y & gi·ªù ƒë·∫∑t l·ªánh</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let order of completedOrders">
        <td class="order-id">
          <a href="#" class="id-link">{{ order.id }}</a>
        </td>
        <td>
          <span class="order-type" [ngClass]="{'buy': order.type === 'Mua', 'sell': order.type === 'B√°n'}">
            {{ order.type }}
          </span>
        </td>
        <td>{{ order.amount }} USDT</td>
        <td>{{ order.totalPrice | number:'1.0-0' }} VND</td>
        <td>{{ order.price | number:'1.0-0' }} VND</td>
        <td>
          <span class="partner-name">{{ order.partner }}</span><br />
          <button class="chat-btn">Tr√≤ chuy·ªán ‚å®</button>
        </td>
        <td class="status canceled">{{ order.status }}</td>
        <td>{{ order.time }}</td>
      </tr>
    </tbody>
  </table>

  <!-- Table hi·ªÉn th·ªã l·ªánh ƒëang ch·ªù x·ª≠ l√Ω -->
  <table *ngIf="tab === 'pending' && filteredOrders.length > 0" class="order-table">
    <thead>
      <tr>
        <th>ID l·ªánh</th>
        <th>Lo·∫°i l·ªánh</th>
        <th>S·ªë l∆∞·ª£ng ƒë·∫∑t l·ªánh</th>
        <th>S·ªë ti·ªÅn ƒë·∫∑t l·ªánh</th>
        <th>ƒê∆°n gi√°</th>
        <th>ƒê·ªëi t√°c</th>
        <th>Tr·∫°ng th√°i l·ªánh</th>
        <th>Ng√†y & gi·ªù ƒë·∫∑t l·ªánh</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let order of filteredOrders">
        <td class="order-id">
          <a href="#" class="id-link">{{ order.id }}</a>
        </td>
        <td>
          <span class="order-type" [ngClass]="{'buy': order.type === 'Mua', 'sell': order.type === 'B√°n'}">
            {{ order.type }}
          </span>
        </td>
        <td>{{ order.amount }} USDT</td>
        <td>{{ order.totalPrice | number:'1.0-0' }} VND</td>
        <td>{{ order.price | number:'1.0-0' }} VND</td>
        <td>
          <span class="partner-name">{{ order.partner }}</span><br />
          <button class="chat-btn">Tr√≤ chuy·ªán ‚å®</button>
        </td>
        <td class="status pending">
          ƒêang ch·ªù thanh to√°n<br />
          {{ order.remainingTime }}
        </td>
        <td>{{ order.time }}</td>
      </tr>
    </tbody>
  </table>

  <!-- Kh√¥ng c√≥ d·ªØ li·ªáu -->
  <div *ngIf="tab === 'pending' && filteredOrders.length === 0" class="no-records">
    <div class="no-records-icon">üìÑ</div>
    <div class="no-records-text">
      <strong>Kh√¥ng t√¨m th·∫•y h·ªì s∆°</strong><br />
      <span>Ch∆∞a c√≥ l·ªánh ƒëang ch·ªù x·ª≠ l√Ω</span>
    </div>
  </div>

</div>